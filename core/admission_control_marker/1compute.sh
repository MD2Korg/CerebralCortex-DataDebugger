#!/usr/bin/env bash

# Python3 path
export PYSPARK_PYTHON=/usr/bin/python3.6

#Spark path
export SPARK_HOME=/usr/local/spark/

# path of cc configuration path
CC_CONFIG_FILEPATH="/cerebralcortex/code/config/cc_starwars_configuration.yml"

# list of features to process, leave blank to process all features
FEATURES="typing"

# study name
STUDY_NAME="mperf"

# start date
START_DATE="20171001" #"20171103"

# end date
END_DATE="20180530" #"20171111"

# list of usersids separated by comma. Leave blank to process all users.
USERIDS="c6156900-915c-43bd-a1c4-37d9c1f8da62,20940a76-976b-446e-b173-89237835ae6b,31d42f9e-627c-489a-9c24-4513af7c7511,2eb6842a-1240-43d3-9fdb-954a614411a9,d76db16a-b758-4094-8bfe-4f7167555b73,fb059e16-0830-4f1c-aefd-96552be9def3,9a83ff80-8eed-4441-ba88-e014bb7bda8d,5be23791-acea-413c-9921-fe8ebe055eb5,f244a6e2-97bf-4c57-8fb9-ed1ca1774c37,b7c267ae-857f-4f5f-9c24-f5236bba1f89,4c8cf704-9adc-4c01-ab25-3addbd69c308,fd36e160-50a0-4dad-9357-65ea218c8d3c,32dfe358-f0d7-4a3c-ba2c-1308f89a9d24,d4505c6f-2bf5-4aba-8946-5923118c96ce,c26a7ffb-10d2-40d4-aa34-3b4094d77393,64bbc562-abb8-4cf4-8a1c-850a4ada5673,c508e151-eef0-419c-9cb4-e7b1c3337873,f7046a1b-17ad-41f8-a58e-fc658ec73392,c7e9149b-94da-4733-92eb-1395c724fc7b,b4dfa455-19e0-4323-96cc-1801e9721b08,1ce063ce-f475-4a3f-aafb-633adc0d3798,f64854af-f444-4489-9cc2-05800227f406,d1392516-4b33-47c0-81b2-066fa7210135,8b3d78b4-1e27-4633-abb1-15617b599d2d,072c81f7-4410-4301-8fd0-17337c0ac1e8,7685d242-8ebe-4e06-8a9f-d7c2844ead10,a9531f87-726f-4063-b18d-cd176dcf4b90,08b3a46a-f926-4a57-8723-b78b53c33729,7975e62d-7cdb-40b1-85d7-b93a69a75421,e033e92f-a7ef-4328-821c-e377fb95b01d,9cda59ce-e592-41ae-b0e2-c17d81301916,a4419c21-104b-4b4d-a95f-7682f23aa319,7bd22d5b-adf3-4b9e-8ead-a7f1ddc01171,db4a2be2-d180-4fa5-b3b8-41b91c2a641c,43d62e76-2b24-4626-bcf4-35594eddf7a8,ae38c092-2080-44c2-b1c9-094916a5c97a,253caa97-394d-4b96-a4a0-00ea8a89e58d,8e270a06-c212-4ff4-8a73-be96312fdaf7,29887429-a8a6-4406-9323-2caa79c491ce,b39f9f83-5621-4a30-b6e1-1f21acd3b7c8,58e04a3a-1f6d-453c-9250-5b218ba2e99c,8726f4c1-1507-4a6b-ae29-9b13fd9ce9e2,efc3b444-ae8b-4106-8cfe-689e0cb4dbb9,e2514141-ebd8-471a-920b-e023437ab0e7,52f0c8e1-0dff-489e-9947-1ce84add2922,4e46e9d6-89cb-4bbc-a07f-121da6f45a5b,e06ad7f2-fedc-4e33-8315-303e5bbd2406,1d2e8082-bc73-4a11-9665-a474ce801b77,1a726f3b-e270-47ed-ab4d-814ff7dfa5c5,220d3add-c6c8-4f22-a2d7-f16501f92f45,dd1dccdf-1b41-415d-8a38-9db4b2a548cf,c64d24d2-dfb3-4113-bdd9-5a5b3be2b416,bb537527-6ab6-4693-a905-a01e5af3b981,b7a05945-a70a-4196-a3bf-d49313a5d12a,d76548a5-a8e3-45b9-8d7b-de96bc275d87,2ee7bcdb-66a6-4ff1-8ddb-2f7569ad4976,c2dc579e-47c5-4498-857a-2f765406b8a5,326a6c55-c963-42c2-bb8a-2591993aaaa2,24ea7a3f-4b4d-48a0-a256-6de2e8298d25,56b8d410-341c-4e90-ad7c-3e8bf1cbb0b6,17b07883-4959-4037-9b80-dde9a06b80ae,f2aa92b3-ac1a-4afe-9dda-977c07ee8ee2,03ec3750-641a-4039-8b5d-74b485bde1ea,d9aa9a5c-e496-4da7-ab67-adabc1f37c72,dde1ede1-50cc-4ce5-9f4a-fdd3a8f1e3dc,2ac8cb80-76be-4903-bcae-9f2c9b8b992f,784af6b8-2218-4e01-a066-b66eb2832d9d,d83ac187-97cd-4ee0-a35f-5a1ffe6c7885,cd6f425b-92fe-4bdf-b277-53a558fc7c27,b6a84ed4-e9d1-4df9-a293-938666fb512b,24809752-2bcd-424f-aac1-5d909026b0c4,55675812-1eac-44e0-a57d-30a5a9ae083e,0d843c9a-5c9d-4325-bae6-e44e0902e84a,61d1a237-d70f-49b0-89ba-cea4d2526832,985b1b37-40be-49aa-9df1-31aff97dfb1a,ae2fae6b-0365-4a35-baee-144f2642cac4,f80e8b55-30d6-47fd-8f12-851016b0b0fa,74fd99d6-7bfc-40ae-b90f-1639c79294d3,0c824653-a13b-4a4e-b907-660f1d8f8981,92e8540c-3290-407d-9114-8458b9bd211a,038aafca-cc30-47c6-9cbe-5c2cb52d8f04,00ab666c-afb8-476e-9872-6472b4e66b68,4203df44-c6be-49a5-93b8-a9047d438fe4,94eb0755-56a3-4235-b759-8dc2ced70875,4d7d8db6-d135-4db5-a718-11582822ff1a,17b79ee0-4d3c-44ac-bfea-90b1f0540d4b,3b9ff2e4-dfec-4022-8994-1a0c4db7227a,58ec107b-68e2-4742-a497-d8d4af1523ee,5dc54855-a59b-47e3-867b-46eb1c789b23,aa45a425-2c17-46de-8bc8-cbe080158c80,53db5d5c-fe90-47d1-8252-c05566bf03e7,2946b01f-4cda-4f69-9b3f-24aed26c4d15,3ea4837f-104a-44d3-a006-4bc586c0f829,d197d735-bb0d-4df5-9566-2325de86e98b,13555453-55fc-4b13-8b32-b49dfcc9a8f0,3b4966d8-f38a-46cc-ba12-4f059b753241,176dfa9b-725b-4813-9219-005041320db4,a5e9c6b1-40b2-4763-862b-61811f58f2cb,3ca29402-0a0d-4f08-8f6c-5b57672809f6,f4aafd07-9711-4850-a6b6-63efa2fe25c6,3ff76631-5492-4693-8b20-73b5a6c8864d,942445c5-eb52-4128-98ca-0fbb5dd6aca4,e2ee5efe-d9cf-482c-8c73-a895185e3524,03c26210-7c9f-4bf2-b1c2-59d0bd64ffac,b61ebedd-272f-4276-9eee-63bb9e1a4ad6,3d1e1b85-e0de-46a9-853f-4c3aa2e56271,d7eb1a8a-344d-463c-a660-9b4ef56a8b63,b8bbd940-ba64-474c-bfea-37e578fc2133,166b9e2f-08a1-425f-9617-875d6ad3f834,ea8ee8f7-b950-4cbb-95f7-c87da15d3e82,1c3e4944-1d23-4654-be10-c37b5806d00d,862ab494-446d-43f6-b752-af51e938547e,8861a2f4-80be-4c62-8c1e-252efad26ccc,e3c665c2-f7b6-4be6-99a4-197af6f01bdf,a6c16f12-0987-4690-87fe-336710f96398,40556c24-113c-49f9-9371-34931d4fba2d,c1f31960-dee7-45ea-ac13-a4fea1c9235c,3c77a951-188c-4c57-93b0-b7a194d4cc19,dc9199c5-f484-4da4-8bf4-de8319628d35,ee179373-c30e-4ef2-9f32-75419e005cf4,472c78e7-d814-4f61-9128-336d13fb9a0f,febb3cef-56cc-4f40-b7c2-7c2663b0dc33,8c2f443e-b329-42f2-a1cf-31c150be47e0,8fcc208a-30e9-49dc-b9de-51e6819a50b7,df2b2506-6a64-4f94-8b7c-171a373387a3,30fe7844-15f8-4c6b-b1d6-a642f43616b4,9d7b2444-3411-4252-aa07-fdd2b1aa60ad,f611477f-7b2e-4f36-81da-c6cdee27d7a1,9c0a19ac-3240-4e0e-9e1d-b49b74681ce0,c2b6746a-5780-47c2-bee3-db18bfccd409,e7500981-9b13-4238-a855-52b91ed6244d,8cd3bb5b-32f7-4275-b789-bbcd7de0ee53,36f6e239-816a-4508-9126-3b612741c26d,37733a30-f84c-416d-977f-ac3a5b2a68c4,ded067ce-6c9a-4b7d-93ca-b848b6977d45,c81cafe4-2589-4207-b8ba-6abbc2e311c2,95085684-88ec-4d2a-8eba-a38268018193,e4e6552b-35bf-4df8-8302-c9cc304d34f1,35fff957-2ad7-40e6-b57a-30235da5c9a9,24e24816-b56b-4c16-9e6d-0ae8afc8650f,fecd1ca1-4240-42ab-ab94-bfb993a1da11,0990887a-6163-4c80-9c9e-468ea2598202,5034a63c-298d-4d16-bfd7-7510c09b78d3,83ff3fe4-b456-47ac-a5fa-1d152f900235,0ce0209c-ee94-4ef0-9bea-5caad065b103,b3aed23e-d863-4a87-8c38-309cf958f930,f16d63b1-c63a-42e0-80c9-aa18ec513da3,02e82ef0-acb8-4366-8c83-4c3f2f69f7ea,44e31af4-7a40-4124-8dc4-d14b12dd66c7,3aa0bbf3-e880-4a78-8a97-de9834b2eb18,b2bc6b0a-b4f0-4ebf-829a-a2f28addae50,36caadf6-9bd5-4bac-9f13-75d2f439b4de,3833df3d-dc81-4467-bdd9-16a7d99f7edb,ee641ee3-b4b9-4a2f-8394-ebda81037fe4,80134e57-9f6a-42e6-bd13-01875b5af715,87d70bed-3ed0-455c-a144-9fd955229125,d609008d-6efb-4cd0-ab84-6c0de55198db,b00fe5cd-a973-4f16-93e1-b15b5ea1d7e2,d36edb42-c422-41b4-b82f-594d8f3850be,1b524925-07d8-42ea-8876-ada7298369ec,5134cb88-3e01-4861-a585-395201e803c9,4b0f6e44-14a3-4cd9-abab-e279af6f45c6,8b73cf24-6579-4a9f-b7db-62317feb4d58,b64eaa81-425f-446a-a521-9fdd9429f77b,d41622a7-9fe7-4f6c-9e19-62b431c9e36b,de4021b2-547f-4a26-a3ac-daba9c71edd0,059a9d92-4d36-40cb-84cc-408f9210821b,51ebb070-7d34-40b3-8520-55d2e318438a,20bae182-cdd9-4e73-a584-f337bbfa55df,94291262-3794-449e-a4c8-f62de9529977,f5abb4f1-ad31-4964-988c-14769501a8f7,34ce3561-6cd1-43e8-8a5b-c1d468863166,42ded059-c890-42e1-adb8-4b339d0879b5,8c9f9374-4398-4b3c-92b7-2c66dc4fcbd5,c4c0c196-c6a7-41fd-bdf1-99002be6e841,ba79fc54-e083-40e7-ae36-fae72980f2d0,110a98b6-ef01-44b2-a19c-9ab8db1dd6fa,a54d9ef4-a46a-418b-b6cc-f10b49a946ac,5af23884-b630-496c-b04e-b9db94250307,53b45c45-9ca0-4ec9-b54d-90ffdfec0c38,bb23dbbc-b679-4849-b1d8-63279cad50e2,b4ff7130-3055-4ed1-a878-8dfaca7191ac,20a07a1c-ee7e-4958-a2c8-0db6e4fe0ce9,d3d33d63-101d-44fd-b6b9-4616a803225d,a173be18-19f9-4485-8143-0ac56b45b1eb,26eeb04e-ab64-45b2-bb12-7aff7a779f9a,3b4f130b-0287-42ac-975d-ecd4f7377b0f,a6006dcb-2c1a-4e66-8db0-d9deb6c93752,3b6fda64-bb3f-4a77-bec0-7ba034d4540e,2fb5e890-afaf-428a-8e28-a7c70bf8bdf1,a8049cb2-a13b-48f7-abe3-cf42f60368aa,e3d59499-2840-4a2c-81fc-19f8f12f0a65,21faaa13-7447-420f-aa5f-7a2e128d06aa,f29a8628-ed1d-445a-9316-b4eb62fed4d7,879233b3-262c-4b19-a344-f4d595d08d26,e44afc25-08b9-432e-ba89-7f0fc80b95cf,82d8787f-ed86-41a0-b342-451c6064dc59,a60bbc2d-4d45-4896-b533-15c2cd54cf60,8d458ff0-0ed3-446d-bd87-cd23dae0a05f,ac9b4778-0bb5-4384-b4ed-3a5738ba99a4,ae4e4f1a-098a-4906-a2c9-78a68f4cdd14,397c6457-0954-4cd2-995c-2fbeb6c72097,1a2eb8d4-077e-4c0b-88d9-574872b45e4c,ec533293-9f82-42ef-9ee1-a7b8c4710dc3,d72be89a-68d7-4ca8-bb97-1cb9be776001,9324c6d7-3fdc-4614-8199-0c102f1b67c0,34521ae7-012a-400f-8794-3d76ff4e70ab,6770c699-3b3c-4333-b70a-b7e7d839e38b,323cc961-5f66-4273-9d46-6097bc692269,c6a176bc-6b30-4066-a7a4-b305ea1df716,30e340a8-776f-40d1-9d8c-d70d38bf0a5f,da66d9bb-0d61-4a3a-afbd-792ac93ebddf,b7e851d4-1cbc-4bd1-a040-d21e68182d49,c9b4e8d8-34f7-474b-9233-db1d945d8fa0,63f5e202-6b13-491a-bdfc-9f13b7e4c036,cdd98fba-4d2c-45d1-94b3-4b6b6077b58e,26d5159f-ca0f-4537-a97d-8ddda3c95f8a,9b7483ba-9c6f-4c67-bf48-549384ac66c7,8aa1bd02-ee43-4e9d-b7f7-7ddc66b607f9,9f5be69d-028c-4020-8140-439e652e2343,1bdf0668-a632-4290-ad94-c6269f9e924a,24d285d2-c1c9-4a9b-ab57-68fe292cf472,75f01e07-425c-46ac-bcfc-aba98f2b02be,089cc9f8-044f-40d6-aca9-af76bf35e4d2,cf9ee6f5-94ff-4097-a751-b8ed7c2a2e4b,feaad88c-c9f0-405a-a32f-4c9adfc0be6b,5aeb56d6-af68-4189-a8ec-1f8d8a0c9e02,95a070a7-086b-4f3d-a5ba-0a877f7fabf7,9187dcd7-7b5c-4633-ae73-af8200f1dfba,077ff26a-4f7b-48d2-833e-1b9d31cb7615,ecfb8b5b-9e00-4faf-98f6-1e5d42140e3b,ab6ffd82-1f4f-448a-a4a2-b0d8e861fc81,da6b7c06-9bb4-45d0-b8c7-e7dadf77285c,eb351488-1a8b-4521-831d-9d9d0d1dc208,843651b8-938f-4b33-9e5e-58a00a568c59,6cd16a05-3496-4c8e-a915-b44ac950e241,a73e8ebf-1c4d-4a05-acf7-8b834b1f3b85,6f157d6b-d974-4ec4-9c93-7e29bdaf0108,4ac3f410-c8fd-4cf6-a065-405683c27499,274739ff-aa7f-4b93-a409-67217327140c,622bf725-2471-4392-8f82-fcc9115a3745,efa1c292-bb43-420f-a229-1d1da9901b13,157022dd-d527-460d-8abc-dca2f3310394,583dc6e7-fabe-4d2a-b633-4ad5aea67f8c,e118d556-2088-4cc2-b49a-82aad5974167,41bf78e2-4791-4d2e-9459-22f401074964,03996723-2411-4167-b14b-eb11dfc33124,360dda05-d7a7-4ec3-8988-256bb6381cda,be4297a8-d763-42e2-a2cb-cab38f64cfe3,5cd4f692-3b13-4728-9df3-debc682e42dd,351fbcd3-c1ec-416c-bed7-195fe5d1f41d,136f8891-af6f-49c1-a69a-b4acd7116a3c,d4691f19-57be-44c4-afc2-5b5f82ec27b5,2b6a9abb-9a75-4d1b-8cab-5dd862626349,50846a75-cde7-44d0-878d-bedc39726f75,ec7bb904-196c-4040-997e-d5e23ad1a553,1b46a6a9-0e7d-4740-b101-b5bc28154f2c,f1a772e9-bf5f-4bc9-96ea-7a45f38c8c41,bbc41a1e-4bbe-4417-a40c-64635cc552e6,61519ad0-2aea-4250-9a82-4dcdb93a569c,a7e8df51-db85-42c3-9ebe-207dcd736793,58c394c6-19ba-48ad-9bc2-bc3efb4053b5,900b0dc1-b236-4364-bbab-0371af4eef84,df11d649-9c87-4802-b602-ec97c3e868b1,c9b351d9-124b-4119-8be8-cb7c0f7e7994,b43f7bd1-6472-4767-a175-d943f595e9ff,9d18a57c-ae79-434c-81f9-b20e9f0e21d3,a262930d-17eb-4053-840c-a8f9fb035a00,16db9568-bd11-494f-b712-28a2266ea3d0,3ca3dbf5-2390-409e-bd2c-c9f23a255e75,9658fd5d-f8bf-4fd3-ba8d-6e40776039de,135c9c3b-a5cf-47a4-9fcf-4fc418c5eb96,8acefded-803b-4cf3-9829-18bd5508f907,055bed5b-60ec-43e6-9110-137f2a36d65b,9580deeb-f28e-42e9-a877-1a6e1cea3dff,83e9c0b8-b6a7-4c19-8deb-2bca29b93139,2b4ae7c4-ee25-4588-a0cd-bffb64a07f7f,2d954abb-e11a-4f25-8f12-19a210c8d8e1,b4b75916-a561-41e4-b3b9-5dfc2859028d,6b74bbc2-128a-4206-82e1-eaec79579c51,479eea59-8ad8-46aa-9456-29ab1b8f2cb2,912427ec-befd-4a0f-b2ad-36af77198e06,c018eb43-ab13-401d-8743-53cdc93c9e65,34223626-fab9-48f5-82bd-0b0037745994,dd13f25f-77a0-4a2c-83af-bb187b79a389,82a921b9-361a-4fd5-8db7-98961fdbf25a,d1cf1b0a-c3b8-45cc-93bc-792f820f3e92,66c74335-a160-4d1c-8165-8e49a3c03666,41d28e85-3a78-40a8-ad6f-aa22aa02795c,948b8d17-35af-40cc-aa50-70a12b56e433,efb8ddb1-b9a4-4833-a876-c8adc53850ca,07a34e07-8ee4-434b-8c09-6cb197451464,63684250-6bd1-41e6-b270-ebfc5379a271,2f256f48-8336-4846-9362-7349ae648dc5,c73670a9-16ca-43bb-b7b9-110558e31798,46f29cfd-cb46-4ec7-b983-b483268bbe21,45a86c85-0bd3-4f3f-bcdc-2b27cd539288,f744e739-4b60-4f0e-95a5-42c9f2042f1a,77131a79-5ccb-4df8-afa4-14c71d4048b8,c271feb1-dac7-4940-9ef0-cf4de3a6b1db,c7091bfb-1ab2-4fbe-9d09-ae801a2585a2,6bf8a6da-a8c3-45c4-8aa3-75649cd1772d,6fb3efa6-3ede-43c5-bdea-0b64907a68de,bedb175f-d70a-41c0-91f4-573f7b22f675,301734c8-1f4a-4dc7-ad19-7f24e0c4d4f6,fe84e1e8-87b7-463b-99e4-2e492576ccbd,ac3c89bc-11bb-447a-b226-5a4a935e9653,5eaca290-9215-4b6d-907b-756aa17adbd0,89e13844-fa61-46bd-b99f-46423122de5a,0457f007-211c-4dc3-844e-47d724fece51,dd0b3f2a-d12e-4d58-ae4f-17b3ce7f95a4,66a5cdf8-3b0d-4d85-bdcc-68ae69205206,81146c4b-a952-433f-98ed-1a125896d36f,805f3a7b-a197-4834-a4e4-a56da3dde6b1,f77f3c8b-49e6-44fe-92a1-c0b07bbea9e9,34192284-e4f1-4420-ab35-0eb02ce2e8d1,f44b2de7-97bc-4539-8515-f110feec479d,42bbf143-b184-4cf7-9afa-289468d9e36b,682564cb-62be-40ff-b5f6-0f53924d37e3,75f6a3c6-ef3d-43e2-810c-560efaf92592,3893e3e7-24b7-45f3-90e8-e9ca6114e83f,290e568c-16e2-4656-8e04-7298f5884c48,f486f8c2-ea21-4909-9af3-9cd2ff1638bc,b0d888c3-f3d3-4e5c-9dce-bbcb4c15ac58,3d635e50-7f62-444d-b302-8131aae56104,9e4aeae9-8729-4b0f-9e84-5c1f4eeacc74,84f93536-ce17-41eb-9241-10d4b91fd97f,c93a811e-1f47-43b6-aef9-c09338e43947,5accb319-08ca-402a-9778-ad1f0608401b,af533808-e79f-4f2b-994b-969dcf0e4f5d,0a11d9aa-1e9c-4f5e-94cf-faa6e796a855,260f551d-e3c1-475e-b242-f17aad20ba2c,cb29da71-7fe9-4270-83d1-ba58b8034fc6,af8c78cf-7d82-44f0-a277-abe61896b015,de5c2828-29c5-4545-8367-502bb0ed1004,342d9d87-787d-4836-9f61-4d59ed9f3289,e0f51af7-56c6-4c0e-9f0a-6c34ec0ff98a,f2d36ddc-d20e-46c7-974c-fb7fc273db31,9a917ae9-8e47-4eaf-aaff-e82bfc9f7d6b,d3af01d0-31b7-4fd9-af11-83b7bd594b12,21e618f1-2cc1-4179-b001-62b05b3b1f7e,ed1698e5-4104-4b28-a0e7-71d710f2efb7,d3268d64-57ae-4060-937a-7980cdc5ffcd,c7c1cc61-27fa-4bfd-bdef-f3e04c527987,814e0cc2-ed93-4e72-af35-40a41cef21cd,57dc658f-bb87-452c-94fc-9bd6a72b0bcc,d3c0b2d1-4ab7-48e0-8ac4-fc6a104b03d3,7fed6abf-3b16-41e3-8e9d-ec61382bce7e,b1ea5c54-3b28-46c7-bc3a-8dab91d73d6a,c5677eca-f00e-45af-ab0c-7388438c85e3,3f38d579-66fa-4126-b269-3f4e1ee42b39,d2bb3e13-9a98-45e0-8b3d-71b3b89e598f,407d6e31-ffbd-4e84-97ab-54b2ff396823,1fa707a3-63c4-488b-9558-f4d827fc9b12,b404aea2-e1a5-4dba-ad61-8132a3841dcf,8a3533aa-d6d4-450c-8232-79e4851b6e11,b2a7d259-143a-4db7-9406-5a95e020d6b7,c87dcc5b-2846-4eca-b6c2-ecc7ea58bbc7,7b8358f3-c96a-4a17-87ab-9414866e18db,e0830d00-bcac-4084-893a-3b61de64ecf6,1c47637b-d4a1-432f-9810-b6e2daea0a43,f2a3349e-b223-4d54-b7a1-c09664d7d91b,15d069af-7a36-4c33-8693-cc814845b9c3,8013239e-0d75-4640-9ec1-2b9d856956a0,cb8a3787-1e23-4265-bf3d-264bfe6b25e8,5b1ab5af-701b-4717-9c43-98ab90a89325,ddf11c46-b071-4f00-82bc-c0ee74d78aa0,6b6cee83-d69e-4a7a-b959-ee2de109d907,8cee7fce-00d0-45f1-81fe-b24bb7176679,f9351b3e-e4de-4d94-b3bc-98786d35906b,2bc2ade2-b154-4412-878c-98466a00ba7b,67aeb5af-38f7-4949-b59f-608896d20077,c576bedb-b0f7-4458-a1e0-24071d6e1d36,28fba926-ef44-4874-a209-ac6680441822,65df4c37-b8a5-443d-b488-4b92ecc891d0,c696b0e8-299f-4270-9218-25f973bc64b4,b18bc631-88a3-4c7a-89aa-14b3350aa48d,fbd7bc95-9f42-4c2c-94f4-27fd78a7273c,0bee012c-efcb-4512-8c29-13d0a935cb48,67556c68-b9a4-49e5-a3d6-7dc3c7b3e0ec,53400e38-644f-40bf-9968-b11f6682e7e5,ac48132f-2c65-4762-bb64-ed8f733a540d,d0966bbb-d634-419e-ba57-8cf6de4e98ee,05180b17-aae0-4920-bfd0-96b062017f7d,757093f1-191a-4c71-9c28-92d476959e27,c1d277ee-1f7a-4dd1-b50a-40a8540d381b,35daf881-da7c-4779-a8e9-20a3985094e2,b8e437d3-d8db-48c3-91b5-ebd6ab29662f,e6b87c27-0b3b-4851-8fb6-7c366a6af508,dbd205d8-339f-4432-aafc-a983ee553245,4e13c9d7-58c9-4ab5-b111-f5c0a8ed05e2,84b129ce-028e-4709-b410-ba9f18d29902,c6574c0d-ceca-4584-af55-d8e7e282ed8d,7260c523-b2d5-4bdc-a831-96b4815dca00,022e4ff8-e1af-43dc-b747-862ac83518d2,56b4bef0-2bbb-4e2a-b434-36bfdb2f0f7e"

SPARK_MASTER="spark://dagobah10dot.memphis.edu:7077"

CC_EGG="/cerebralcortex/code/eggs/MD2K_Cerebral_Cortex-2.2.2-py3.6.egg"

PY_FILES=${CC_EGG} #",dist/MD2K_Cerebral_Cortex_DataAnalysis_compute_features-2.2.1-py3.6.egg"


SPARK_UI_PORT=4066

MAX_CORES=24

# set to True to make use of spark parallel execution
SPARK_JOB="True"

# build before executing

# python3.6 setup.py bdist_egg

if [ $SPARK_JOB == 'True' ]
    then
        echo 'Executing Spark job'
        spark-submit --master $SPARK_MASTER \
                     --conf spark.ui.port=$SPARK_UI_PORT \
                     --conf spark.cores.max=$MAX_CORES \
                     --conf spark.app.name='data_quality' \
                     --py-files $PY_FILES \
                     phone_stream_analyzer.py
    else
        echo 'Executing single threaded'
        export PYTHONPATH=.:${CC_EGG}:$PYTHONPATH
        echo $PYTHONPATH
        python3.6 phone_stream_analyzer -c $CC_CONFIG_FILEPATH \
                       -s $STUDY_NAME -sd $START_DATE \
                       -ed $END_DATE -u $USERIDS -f $FEATURES 

fi

